recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
?as_factor
data = df %>%
select(provider = provider_detailed,
id_crs = as_factor(as.numeric(crs_identification_n)),
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
look_for(df)
data = df %>%
select(provider = provider_detailed,
id_crs = as.numeric(crs_identification_n),
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
data = df %>%
select(crs_identification_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
View(df)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
df <- read_excel(here('data','CRDF-RP-2017.xlsx'),
sheet = '2017') %>%
clean_names()
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = is_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = to_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
unique(data$rio_adaptation)
View(data)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = as.factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = as_factor(adaptation_objective_applies_to_rio_marked_data_only),
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
?select
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
as_factor(adaptation_objective_applies_to_rio_marked_data_only) = rio_adaptation,
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
)
look_for(data)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_if(is.character, is.factor)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_if(is.character, as_factor)
data = df %>%
select(
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
channel_of_delivery,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
data = df %>%
select(crs_identification_n,
donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
channel_of_delivery,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
data = df %>%
select(id_crs = crs_identification_n,
id_donor = donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
channel_of_delivery,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant = adaptation_related_development_finance_commitment_2021_usd_thousand,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
data %>%
summarize(sum = sum(value_constant), .by = recipient_region)
?sum
data %>%
summarize(sum = sum(value_constant, na.rm = TRUE),
.by = recipient_region)
data %>%
summarize(sum = sum(value_constant, na.rm = TRUE),
.by = recipient_region) %>%
arrange(desc(sum))
# Top recipients
data %>%
summarize(value = sum(value_constant, na.rm = TRUE),
.by = recipient) %>%
arrange(desc(value))
unique(recipient_region)
unique(data$recipient_region)
# Top recipients in Africa
data %>%
filter(recipient_region %in% c('Africa', 'South of Sahara', 'Unspecified')) %>%
summarize(value = sum(value_constant, na.rm = TRUE),
.by = recipient) %>%
arrange(desc(value))
look_for(df)
data = df %>%
select(id_crs = crs_identification_n,
id_donor = donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
channel_of_delivery,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant_adaptation = adaptation_related_development_finance_commitment_2021_usd_thousand,
value_constant_climate = adaptation_related_development_finance_commitment_2021_usd_thousand,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
# Top adaptation recipient regions
data %>%
summarize(value = sum(value_constant_climate, na.rm = TRUE),
.by = recipient_region) %>%
arrange(desc(value))
# Top adaptation recipient countries
data %>%
summarize(value = sum(value_constant_climate, na.rm = TRUE),
.by = recipient) %>%
arrange(desc(value))
# Top adaptation recipient countries in South of Sahara
data %>%
filter(recipient_region %in% c('Africa', 'South of Sahara', 'Unspecified')) %>%
summarize(value = sum(value_constant_climate, na.rm = TRUE),
.by = recipient) %>%
arrange(desc(value))
ethiopia = data %>%
filter(recipient == 'Ethiopia')
tapply(ethiopia$value_constant_adaptation, ethiopia$provider, summary)
View(ethiopia)
pacman::p_load(
# setup
here,
tidyverse,
readxl, # read excel
labelled, # look_for()
janitor, # clean_name()
dlookr
)
compare_numeric(ethiopia, value_constant_adaptation, value_constant_climate)
ethiopia = data %>%
filter(recipient == 'Ethiopia' & rio_adaptation == 2)
ethiopia = data %>%
filter(recipient == 'Ethiopia')
ethiopia = data %>%
filter(recipient == 'Ethiopia' & rio_adaptation == 'Principal')
View(ethiopia)
ethiopia$value_constant_adaptation = ethiopia$value_constant_climate
ethiopia$value_constant_adaptation = ethiopia$value_constant_climate
identical(ethiopia$value_constant_adaptation, ethiopia$value_constant_climate)
ethiopia = data %>%
filter(recipient == 'Ethiopia' & rio_adaptation == 'Principal')
identical(ethiopia$value_constant_adaptation, ethiopia$value_constant_climate)
ethiopia %>% select(-value_constant_climate) %>%
rename(value = value_constant_adaptation)
ethiopia = data %>%
filter(recipient == 'Ethiopia' & rio_adaptation == 'Principal')
identical(ethiopia$value_constant_adaptation, ethiopia$value_constant_climate)
ethiopia = ethiopia %>% select(-value_constant_climate) %>%
rename(value = value_constant_adaptation)
df = read.csv(here('data', 'c21e99ae-9e34-4920-b594-6dfbccc57a77.csv'))
View(df)
look_for(df)
df %>%
select(default_currency, hierarchy, iati_identifier,
starts_with('other_identifier'),
other_identifier_type, other_identifier_owner_org_ref, other_identifier_owner_org_narrative,
reporting_org_ref, reporting_org_type, reporting_org_narrative,
participating_org_ref, participating_org_type, participating_org_role, participating_org_activity_id, participating_org_crs_channel_code, participating_org_narrative,
activity_status_code
)
df %>%
select(default_currency, hierarchy, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
)
data = df %>%
select(default_currency, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
)
View(data)
df <- read_excel(here('data','CRDF-RP-2017.xlsx'),
sheet = '2017') %>%
clean_names()
head(df)
look_for(df)
data = df %>%
select(id_crs = crs_identification_n,
id_donor = donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
channel_of_delivery,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant_adaptation = adaptation_related_development_finance_commitment_2021_usd_thousand,
value_constant_climate = adaptation_related_development_finance_commitment_2021_usd_thousand,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
df_2000_21 <- read_excel(here('data','CRDF-RP-2000-2021.xlsx'),
sheet = 'All') %>%
clean_names()
data_2021 = df_2000_21 %>%
filter(year == 2021)
data_2021 = df_2000_21 %>%
filter(year == 2021) %>%
select(id_crs = crs_identification_n,
id_donor = donor_project_n,
provider = provider_detailed,
extending_agency,
recipient,
recipient_region,
channel_of_delivery,
rio_adaptation = adaptation_objective_applies_to_rio_marked_data_only,
value_constant_adaptation = adaptation_related_development_finance_commitment_2021_usd_thousand,
value_constant_climate = adaptation_related_development_finance_commitment_2021_usd_thousand,
purpose_code,
sector_detailed,
sub_sector,
financial_instrument
) %>%
mutate_at(c('provider', 'extending_agency', 'recipient', 'recipient_region',
'rio_adaptation', 'channel_of_delivery', 'sector_detailed',
'sub_sector', 'financial_instrument')
, as_factor)
df_eth = read.csv(here('data', 'ab840493-9edc-4641-955a-6760a14b0b88.csv'))
df_eth = read.csv(here('data', 'd876c18f-5896-448a-84ed-d2a5324095a6.csv'))
View(df_eth)
data = df %>%
select(default_currency, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
title_narrative,
description_narrative
)
data_eth_2017 = df_eth %>%
select(default_currency, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
title_narrative,
description_narrative
)
View(data_eth_2017)
df_eth_2019 = read.csv(here('data', '11980eac-6e3d-4639-ac19-f4e5e276eaaa.csv'))
View(df_eth_2019)
data_eth_2019 = df_eth_2019 %>%
select(default_currency, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
title_narrative,
description_narrative
)
View(data_eth_2019)
pacman::p_load(
# setup
here,
tidyverse,
readxl, # read excel
labelled, # look_for()
janitor, # clean_name()
dlookr, # identical()
visdat # vis_miss()
)
data_eth_2019 %>% select(starts_with('location')) %>%
vis_miss()
df_eth_2019 = read.csv(here('data', 'c15e7d39-26ee-427b-916c-f0b3046931f3.csv'))
data_eth_2019 = df_eth_2019 %>%
select(default_currency, iati_identifier,
starts_with('other_identifier'),
starts_with('reporting_org'),
starts_with('participating_org'),
starts_with('activity'),
starts_with('location'),
title_narrative,
description_narrative
)
data_eth_2019 %>% select(starts_with('location')) %>%
vis_dat()
